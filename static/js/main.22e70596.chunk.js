(this["webpackJsonpvirtual-background-demo"]=this["webpackJsonpvirtual-background-demo"]||[]).push([[0],{14:function(e,n,t){},16:function(e,n,t){},18:function(e,n,t){"use strict";t.r(n);var r=t(1),i=t.n(r),c=t(5),u=t.n(c),l=(t(14),t(3)),o=t.n(l),a=t(6),d=t(9),s=t(7),v=t(8),f=t.p+"static/media/alo.20246286.jpg",b=(t(16),t(0)),h=function(){var e=Object(r.useRef)(null),n=Object(r.useRef)(null),t=Object(r.useRef)(null),i=Object(r.useRef)(null),c=Object(r.useRef)(null),u=Object(r.useRef)(null),l=Object(r.useState)(null),h=Object(d.a)(l,2),j=h[0],g=h[1];Object(r.useEffect)((function(){m()}),[]),Object(r.useEffect)((function(){var e;(null===n||void 0===n?void 0:n.current)&&(u.current=null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.getContext("2d"),O())}),[n]),Object(r.useEffect)((function(){var t;j&&(e.current.srcObject=j,u.current=null===n||void 0===n||null===(t=n.current)||void 0===t?void 0:t.getContext("2d"))}),[j]),Object(r.useEffect)((function(){O(c)}),[c]);var m=function(){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){g(e)})).catch((function(n){e.current.srcObject=null}))},O=function(n){t.current.hidden=!0,c.current=n;var r=new s.SelfieSegmentation({locateFile:function(e){return"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/".concat(e)}});r.setOptions({selfieMode:!0,modelSelection:1}),r.onResults(p);var i=new v.Camera(null===e||void 0===e?void 0:e.current,{onFrame:function(){var n=Object(a.a)(o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.send({image:null===e||void 0===e?void 0:e.current});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),width:480,height:320});i.start(),k()},p=function(e){var t,r;switch(C(),c.current&&(u.current.filter="blur(".concat(10,"px) brightness(").concat(115,"%)"),w(e.segmentationMask),u.current.globalCompositeOperation="source-in",u.current.filter="none"),u.current.drawImage(e.image,0,0,null===n||void 0===n||null===(t=n.current)||void 0===t?void 0:t.width,null===n||void 0===n||null===(r=n.current)||void 0===r?void 0:r.height),c.current){case"blur":x(!0,e.image);break;case"virtual":x(!1,null===i||void 0===i?void 0:i.current);break;default:x(!1,e.image)}u.current.restore()},x=function(e,t){var r,i,c=e?10:0;u.current.globalCompositeOperation="destination-over",u.current.filter="blur(".concat(c,"px) brightness(").concat(125-c,"%)"),u.current.drawImage(t,0,0,null===n||void 0===n||null===(r=n.current)||void 0===r?void 0:r.width,null===n||void 0===n||null===(i=n.current)||void 0===i?void 0:i.height)},w=function(e){var t,r,i;null===u||void 0===u||null===(t=u.current)||void 0===t||t.drawImage(e,0,0,null===n||void 0===n||null===(r=n.current)||void 0===r?void 0:r.width,null===n||void 0===n||null===(i=n.current)||void 0===i?void 0:i.height)},C=function(){var e,t,r;null===u||void 0===u||null===(e=u.current)||void 0===e||e.clearRect(0,0,null===n||void 0===n||null===(t=n.current)||void 0===t?void 0:t.width,null===n||void 0===n||null===(r=n.current)||void 0===r?void 0:r.height)},k=function(){var e,r,i=null===n||void 0===n||null===(e=n.current)||void 0===e?void 0:e.captureStream();t.current.srcObject=i,(null===t||void 0===t||null===(r=t.current)||void 0===r?void 0:r.hidden)&&(t.current.hidden=!1)};return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)("h3",{children:"Canvas:"}),Object(b.jsxs)("div",{className:"video-container",children:[Object(b.jsx)("canvas",{className:"output-canvas",ref:n,width:"480px",height:"320px"}),Object(b.jsx)("video",{id:"video",className:"video",ref:e,width:"480",height:"320",autoPlay:!0,playsInline:!0})]}),Object(b.jsx)("h3",{children:"Result:"}),Object(b.jsx)("video",{id:"video-result",className:"video-result",ref:t,width:"480",height:"320",autoPlay:!0,playsInline:!0}),Object(b.jsx)("img",{ref:i,src:f,alt:"bg"}),Object(b.jsxs)("div",{className:"btn-group",children:[Object(b.jsx)("button",{className:"btn",onClick:function(){return O("blur")},children:"Blur"}),Object(b.jsx)("button",{className:"btn",onClick:function(){return O("virtual")},children:"Image"}),Object(b.jsx)("button",{className:"btn",onClick:function(){return O(null)},children:"Clear"})]})]})},j=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,19)).then((function(n){var t=n.getCLS,r=n.getFID,i=n.getFCP,c=n.getLCP,u=n.getTTFB;t(e),r(e),i(e),c(e),u(e)}))};u.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(h,{})}),document.getElementById("root")),j()}},[[18,1,2]]]);
//# sourceMappingURL=main.22e70596.chunk.js.map